import{i as q,u as A,T as U}from"./index-02e4452f.js";import{C,d as N,L as z,k as g,_ as k,r as i,o as h,q as B,w as r,b as t,c as L,F as G,v as j,j as E,x as I,a as _,e as D,y as O,z as J,l as M}from"./index-45934075.js";function P(e){return C({url:"/order/admin/page",method:"post",data:e})}function H(e){return C({url:"/order/admin",method:"post",data:e})}function K(e){return C({url:"/order/admin",method:"put",data:e})}function Q(e){return C({url:"/order/admin",method:"DELETE",data:e})}const V=[{value:0,label:"未支付"},{value:1,label:"已支付"},{value:2,label:"超时"},{value:3,label:"退款"}],S=[{value:1,label:"今天"},{value:2,label:"明天"},{value:3,label:"后天"}],R=N({components:{Layer:z,imageUploader:q},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const u=g(null),m=g(null);let d=g({name:"",cover:""});const f={name:[{required:!0,message:"请输入姓名",trigger:"blur"}],number:[{required:!0,message:"请输入数字",trigger:"blur"}],choose:[{required:!0,message:"请选择",trigger:"blur"}],radio:[{required:!0,message:"请选择",trigger:"blur"}]};s();function s(){e.layer.row&&(d.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:d,rules:f,layerDom:m,ruleForm:u,selectData:V,radioData:S,uploadUrl:A}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){H(e).then(a=>{this.$message({type:"success",message:"新增成功"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){K(e).then(a=>{this.$message({type:"success",message:"编辑成功"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function W(e,a,u,m,d,f){const s=i("el-option"),c=i("el-select"),b=i("el-form-item"),n=i("el-form"),y=i("Layer",!0);return h(),B(y,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:r(()=>[t(n,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px","label-position":"left",style:{"margin-left":"50px","margin-right":"30px"}},{default:r(()=>[t(b,{label:"订单状态",prop:"status"},{default:r(()=>[t(c,{modelValue:e.form.status,"onUpdate:modelValue":a[0]||(a[0]=o=>e.form.status=o),placeholder:"请选择",clearable:""},{default:r(()=>[(h(!0),L(G,null,j(e.selectData,o=>(h(),B(s,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}const X=k(R,[["render",W]]),Y=N({name:"crudTable",components:{Table:U,Layer:X},setup(){const e=E({input:""}),a=E({show:!1,title:"新增",showButton:!0}),u=E({index:1,size:20,total:0}),m=g(!0),d=g([]),f=g([]),s=o=>{f.value=o},c=o=>{m.value=!0,o&&(u.index=1);let v={page:u.index,pageSize:u.size,...e};P(v).then(l=>{console.log(l);let F=l.data.list;Array.isArray(F)&&F.forEach(p=>{const $=V.find(w=>w.value===p.status);$?p.statusName=$.label:p.statusName=p.status;const T=S.find(w=>w.value===p.radio);T?p.radioName=T.label:p.radio}),d.value=l.data.list,u.total=Number(l.data.total)}).catch(l=>{d.value=[],u.index=1,u.total=0}).finally(()=>{m.value=!1})},b=o=>{let v={ids:o.map(l=>l.id).join(",")};Q(v).then(l=>{M({type:"success",message:"删除成功"}),c(d.value.length===1)})},n=()=>{a.title="新增数据",a.show=!0,delete a.row},y=o=>{a.title="编辑数据",a.row=o,a.show=!0};return c(!0),{query:e,tableData:d,chooseData:f,loading:m,page:u,layer:a,handleSelectionChange:s,handleAdd:n,handleEdit:y,handleDel:b,getTableData:c}}}),Z={class:"layout-container"},x={class:"layout-container-form flex space-between"},ee={class:"layout-container-form-handle"},ae={class:"layout-container-form-search"},te={class:"layout-container-table"};function le(e,a,u,m,d,f){const s=i("el-button"),c=i("el-popconfirm"),b=i("el-input"),n=i("el-table-column"),y=i("Table"),o=i("Layer"),v=I("loading");return h(),L("div",Z,[_("div",x,[_("div",ee,[t(s,{type:"primary",icon:"el-icon-circle-plus-outline",onClick:e.handleAdd},{default:r(()=>[D("新增")]),_:1},8,["onClick"]),t(c,{title:"批量删除",onConfirm:a[0]||(a[0]=l=>e.handleDel(e.chooseData))},{reference:r(()=>[t(s,{type:"danger",icon:"el-icon-delete",disabled:e.chooseData.length===0},{default:r(()=>[D("批量删除")]),_:1},8,["disabled"])]),_:1})]),_("div",ae,[t(b,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=l=>e.query.input=l),placeholder:"请输入关键词进行检索",onChange:a[2]||(a[2]=l=>e.getTableData(!0))},null,8,["modelValue"]),t(s,{type:"primary",icon:"el-icon-search",class:"search-btn",onClick:a[3]||(a[3]=l=>e.getTableData(!0))},{default:r(()=>[D("搜索")]),_:1})])]),_("div",te,[O((h(),B(y,{ref:"table",page:e.page,"onUpdate:page":a[4]||(a[4]=l=>e.page=l),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:r(()=>[t(n,{prop:"id",label:"订单号","header-align":"center",align:"center"}),t(n,{prop:"businessId",label:"商家编号","header-align":"center",align:"center"}),t(n,{prop:"businessName",label:"商家名","header-align":"center",align:"center"}),t(n,{prop:"statusName",label:"订单状态","header-align":"center",align:"center"}),t(n,{prop:"totalPrice",label:"总价","header-align":"center",align:"center"}),t(n,{prop:"userId",label:"买家id","header-align":"center",align:"center"}),t(n,{prop:"createTime",label:"创建时间","header-align":"center",align:"center"}),t(n,{label:"操作",align:"center",fixed:"right",width:"200"},{default:r(l=>[t(s,{onClick:F=>e.handleEdit(l.row)},{default:r(()=>[D("编辑")]),_:2},1032,["onClick"]),t(c,{title:"删除",onConfirm:F=>e.handleDel([l.row])},{reference:r(()=>[t(s,{type:"danger"},{default:r(()=>[D("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[v,e.loading]]),e.layer.show?(h(),B(o,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):J("",!0)])])}const ne=k(Y,[["render",le]]);export{ne as default};
