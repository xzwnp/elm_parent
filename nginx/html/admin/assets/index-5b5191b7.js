import{i as q,u as S,T as A}from"./index-02e4452f.js";import{C as B,d as E,L as z,k as h,_ as k,r as u,o as y,q as _,w as t,b as l,c as U,F as G,v as O,j as $,x as j,a as C,e as F,y as I,z as J,l as M}from"./index-45934075.js";function H(e){return B({url:"admin/adminUser/page",method:"post",data:e})}function K(e){return B({url:"admin/adminUser",method:"post",data:e})}function P(e){return B({url:"admin/adminUser",method:"put",data:e})}function Q(e){return console.log(e),B({url:"admin/adminUser",method:"DELETE",data:e})}const N=[{value:1,label:"美食"},{value:2,label:"小吃"},{value:3,label:"糕点"}],L=[{value:1,label:"今天"},{value:2,label:"明天"},{value:3,label:"后天"}],R=E({components:{Layer:z,imageUploader:q},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const i=h(null),f=h(null);let m=h({name:"",cover:""});const b={name:[{required:!0,message:"请输入姓名",trigger:"blur"}],number:[{required:!0,message:"请输入数字",trigger:"blur"}],choose:[{required:!0,message:"请选择",trigger:"blur"}],radio:[{required:!0,message:"请选择",trigger:"blur"}]};r();function r(){e.layer.row&&(m.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:m,rules:b,layerDom:f,ruleForm:i,selectData:N,radioData:L,uploadUrl:S}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){K(e).then(a=>{this.$message({type:"success",message:"新增成功"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){P(e).then(a=>{this.$message({type:"success",message:"编辑成功"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function W(e,a,i,f,m,b){const r=u("el-input"),s=u("el-form-item"),v=u("image-uploader"),p=u("el-option"),D=u("el-select"),d=u("el-form"),g=u("Layer",!0);return y(),_(g,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:t(()=>[l(d,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px","label-position":"left",style:{"margin-left":"50px","margin-right":"30px"}},{default:t(()=>[l(s,{label:"用户名",prop:"businessName"},{default:t(()=>[l(r,{modelValue:e.form.username,"onUpdate:modelValue":a[0]||(a[0]=o=>e.form.username=o),placeholder:"商家名称"},null,8,["modelValue"])]),_:1}),l(s,{label:"密码",prop:"password"},{default:t(()=>[l(r,{modelValue:e.form.password,"onUpdate:modelValue":a[1]||(a[1]=o=>e.form.password=o),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),l(s,{label:"昵称",prop:"businessAddress"},{default:t(()=>[l(r,{modelValue:e.form.nickname,"onUpdate:modelValue":a[2]||(a[2]=o=>e.form.nickname=o),placeholder:"商家地址"},null,8,["modelValue"])]),_:1}),l(s,{label:"头像",prop:"cover"},{default:t(()=>[l(v,{"image-url":e.form.cover,"onUpdate:image-url":a[3]||(a[3]=o=>e.form.cover=o)},null,8,["image-url"])]),_:1}),l(s,{label:"角色 待完成",prop:"type"},{default:t(()=>[l(D,{modelValue:e.form.type,"onUpdate:modelValue":a[4]||(a[4]=o=>e.form.type=o),placeholder:"请选择",clearable:""},{default:t(()=>[(y(!0),U(G,null,O(e.selectData,o=>(y(),_(p,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}const X=k(R,[["render",W]]),Y=E({name:"crudTable",components:{Table:A,Layer:X},setup(){const e=$({input:""}),a=$({show:!1,title:"新增",showButton:!0}),i=$({index:1,size:20,total:0}),f=h(!0),m=h([]),b=h([]),r=d=>{b.value=d},s=d=>{f.value=!0,d&&(i.index=1);let g={page:i.index,pageSize:i.size,...e};H(g).then(o=>{console.log(o);let n=o.data.list;Array.isArray(n)&&n.forEach(c=>{const V=N.find(w=>w.value===c.choose);V?c.chooseName=V.label:c.chooseName=c.choose;const T=L.find(w=>w.value===c.radio);T?c.radioName=T.label:c.radio}),m.value=o.data.list,i.total=Number(o.data.total)}).catch(o=>{m.value=[],i.index=1,i.total=0}).finally(()=>{f.value=!1})},v=d=>{let g=d.map(o=>o.businessId);Q(g).then(o=>{M({type:"success",message:"删除成功"}),s(m.value.length===1)})},p=()=>{a.title="新增数据",a.show=!0,delete a.row},D=d=>{a.title="编辑数据",a.row=d,a.show=!0};return s(!0),{query:e,tableData:m,chooseData:b,loading:f,page:i,layer:a,handleSelectionChange:r,handleAdd:p,handleEdit:D,handleDel:v,getTableData:s}}}),Z={class:"layout-container"},x={class:"layout-container-form flex space-between"},ee={class:"layout-container-form-handle"},ae={class:"layout-container-form-search"},le={class:"layout-container-table"};function oe(e,a,i,f,m,b){const r=u("el-button"),s=u("el-popconfirm"),v=u("el-input"),p=u("el-table-column"),D=u("el-image"),d=u("Table"),g=u("Layer"),o=j("loading");return y(),U("div",Z,[C("div",x,[C("div",ee,[l(r,{type:"primary",icon:"el-icon-circle-plus-outline",onClick:e.handleAdd},{default:t(()=>[F("新增")]),_:1},8,["onClick"]),l(s,{title:"批量删除",onConfirm:a[0]||(a[0]=n=>e.handleDel(e.chooseData))},{reference:t(()=>[l(r,{type:"danger",icon:"el-icon-delete",disabled:e.chooseData.length===0},{default:t(()=>[F("批量删除")]),_:1},8,["disabled"])]),_:1})]),C("div",ae,[l(v,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=n=>e.query.input=n),placeholder:"请输入关键词进行检索",onChange:a[2]||(a[2]=n=>e.getTableData(!0))},null,8,["modelValue"]),l(r,{type:"primary",icon:"el-icon-search",class:"search-btn",onClick:a[3]||(a[3]=n=>e.getTableData(!0))},{default:t(()=>[F("搜索")]),_:1})])]),C("div",le,[I((y(),_(d,{ref:"table",page:e.page,"onUpdate:page":a[4]||(a[4]=n=>e.page=n),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:t(()=>[l(p,{prop:"id",label:"管理员编号","header-align":"center",align:"center"}),l(p,{prop:"username",label:"用户名","header-align":"center",align:"center"}),l(p,{prop:"nickname",label:"昵称","header-align":"center",align:"center"}),l(p,{prop:"cover",label:"用户头像","header-align":"center",align:"center"},{default:t(n=>[l(D,{src:n.row.cover},null,8,["src"])]),_:1}),l(p,{label:"操作",align:"center",fixed:"right",width:"200"},{default:t(n=>[l(r,{onClick:c=>e.handleEdit(n.row)},{default:t(()=>[F("编辑")]),_:2},1032,["onClick"]),l(s,{title:"删除",onConfirm:c=>e.handleDel([n.row])},{reference:t(()=>[l(r,{type:"danger"},{default:t(()=>[F("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[o,e.loading]]),e.layer.show?(y(),_(g,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):J("",!0)])])}const ue=k(Y,[["render",oe]]);export{ue as default};
